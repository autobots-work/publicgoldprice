<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <!-- SEO -->
  <title>Harga Emas Public Gold Hari Ini - 24 Hours Price Tracker</title>
  <meta name="description" content="Semak harga emas Public Gold hari ini. Harga emas terkini Public Gold GAP 24K. Dikemaskini setiap 3 minit dan direkodkan setiap hari.">
  <meta name="keywords" content="harga public gold, harga emas public gold, public gold hari ini, emas price malaysia, harga emas sekarang">
  <meta name="robots" content="index, follow">
  <link rel="icon" type="image/png" href="/PublicGoldPriceIcon.png">
  <meta name="theme-color" content="#0a0a0f">
  <link rel="canonical" href="https://publicgoldprice.com/ms/">
  <link rel="alternate" hreflang="en" href="https://publicgoldprice.com/">
  <link rel="alternate" hreflang="ms" href="https://publicgoldprice.com/ms/">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://publicgoldprice.com/ms/">
  <meta property="og:title" content="Harga Emas Public Gold Hari Ini - 24 Hours Price Tracker">
  <meta property="og:description" content="Semak harga emas Public Gold hari ini. Harga emas terkini Public Gold GAP 24K. Dikemaskini setiap 3 minit dan direkodkan setiap hari.">
  <meta property="og:site_name" content="PublicGoldPrice.com">
  <meta property="og:image" content="https://publicgoldprice.com/PublicGoldPrice-Featured-Image.jpg">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="Public Gold Price Tracker - PublicGoldPrice.com">

  <!-- Schema Markup -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Dataset",
    "name": "Harga Emas Public Gold Hari Ini - 24 Hours Price Tracker",
    "description": "Data harga emas langsung daripada Public Gold Malaysia GAP 24K, dikemaskini setiap 3 minit.",
    "url": "https://publicgoldprice.com/ms/",
    "publisher": {
      "@type": "Organization",
      "name": "PublicGoldPrice.com",
      "url": "https://publicgoldprice.com"
    },
    "inLanguage": "ms"
  }
  </script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700;800&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">

  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5267120092715349"
       crossorigin="anonymous"></script>

  <style>
    :root {
      --bg:        #0a0a0f;
      --surface:   #13131c;
      --surface2:  #1c1c2a;
      --border:    #2a2a3d;
      --border2:   #3a3a55;
      --white:     #f0f2ff;
      --muted:     #6b6b8a;
      --muted2:    #9494b8;
      --accent:    #e2b96f;
      --up:        #3dd68c;
      --up-bg:     rgba(61,214,140,0.12);
      --down:      #ff5f5f;
      --down-bg:   rgba(255,95,95,0.12);
      --flat-bg:   rgba(255,255,255,0.06);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'JetBrains Mono', monospace; background: var(--bg); color: var(--white); min-height: 100vh; }

    .topbar { position: sticky; top: 0; z-index: 100; background: rgba(10,10,15,0.9); backdrop-filter: blur(20px); border-bottom: 1px solid var(--border); padding: 0 1.5rem; height: 56px; display: flex; align-items: center; justify-content: space-between; }
    .topbar-logo { font-family: 'Outfit', sans-serif; font-weight: 800; font-size: 1.3rem; letter-spacing: -0.3px; }
    .topbar-logo span { color: #e2b96f; }
    .topbar-right { display: flex; align-items: center; gap: 0.5rem; }
    .topbar-nav { display: flex; align-items: center; gap: 0.25rem; }
    .nav-tab { font-family: 'Outfit', sans-serif; font-size: 0.72rem; font-weight: 700; letter-spacing: 1px; text-transform: uppercase; text-decoration: none; padding: 6px 14px; border-radius: 20px; border: 1px solid transparent; transition: all 0.2s; }
    .nav-tab.active { background: rgba(226,185,111,0.15); color: var(--accent); border-color: rgba(226,185,111,0.35); }
    .nav-tab.inactive { color: var(--muted2); border-color: var(--border); }
    .nav-tab.inactive:hover { color: var(--white); border-color: var(--border2); }
    .lang-switch { font-family: 'Outfit', sans-serif; font-size: 0.65rem; font-weight: 700; letter-spacing: 1px; text-transform: uppercase; text-decoration: none; padding: 5px 10px; border-radius: 20px; border: 1px solid var(--border2); color: var(--muted2); transition: all 0.2s; }
    .lang-switch:hover { color: var(--white); border-color: var(--accent); }

    .live-badge { display: flex; align-items: center; gap: 5px; background: var(--up-bg); border: 1px solid rgba(61,214,140,0.25); color: var(--up); font-size: 0.65rem; font-weight: 500; letter-spacing: 1.5px; text-transform: uppercase; padding: 4px 10px; border-radius: 20px; }
    .live-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--up); animation: blink 1.4s ease-in-out infinite; }
    @keyframes blink { 0%,100% { opacity:1; } 50% { opacity:0.2; } }

    main { max-width: 860px; margin: 0 auto; padding: 2rem 1.5rem 5rem; }

    .seo-h1 { position: absolute; width: 1px; height: 1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; }

    .hero { background: var(--surface); border: 1px solid var(--border2); border-radius: 16px; padding: 2rem; margin-bottom: 2rem; position: relative; overflow: hidden; animation: fadeUp 0.4s ease both; }
    .hero::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px; background: linear-gradient(90deg, transparent, var(--border2) 30%, #c8943a 60%, transparent); }
    .hero-top { display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 1rem; margin-bottom: 1.5rem; }
    .hero-label { font-size: 0.68rem; text-transform: uppercase; letter-spacing: 2px; color: var(--muted2); margin-bottom: 0.6rem; }
    .hero-price-wrap { display: flex; align-items: baseline; gap: 0.35rem; }
    .hero-currency { font-family: 'Outfit', sans-serif; font-size: 1.6rem; font-weight: 600; color: var(--muted2); }
    .hero-price { font-family: 'Outfit', sans-serif; font-size: 4rem; font-weight: 800; color: var(--white); line-height: 1; letter-spacing: -2px; }
    .hero-unit { font-size: 0.85rem; color: var(--muted); }
    .hero-change-wrap { text-align: right; }
    .hero-change { font-family: 'Outfit', sans-serif; font-size: 2.5rem; font-weight: 700; }
    .hero-change.up   { color: var(--up); }
    .hero-change.down { color: var(--down); }
    .hero-change.flat { color: var(--muted2); }
    .hero-change-sub { font-size: 0.68rem; margin-top: 4px; letter-spacing: 0.5px; }
    .hero-stats { display: flex; border-top: 1px solid var(--border); padding-top: 1.25rem; flex-wrap: wrap; gap: 0.5rem 0; }
    .stat { flex: 1; min-width: 80px; padding-right: 1rem; }
    .stat + .stat { padding-left: 1rem; border-left: 1px solid var(--border); }
    .stat-label { font-size: 0.6rem; text-transform: uppercase; letter-spacing: 1.5px; color: var(--muted); margin-bottom: 5px; }
    .stat-val { font-family: 'Outfit', sans-serif; font-size: 1.8rem; font-weight: 700; color: var(--white); }
    .stat-val.up   { color: var(--up); }
    .stat-val.down { color: var(--down); }

    .date-section { margin-bottom: 1.5rem; animation: fadeUp 0.4s ease both; }
    @keyframes fadeUp { from { opacity:0; transform:translateY(14px); } to { opacity:1; transform:translateY(0); } }
    .date-row { display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem; }
    .date-pill { font-family: 'Outfit', sans-serif; font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; padding: 4px 12px; border-radius: 20px; white-space: nowrap; }
    .date-pill.today { background: rgba(226,185,111,0.15); color: var(--accent); border: 1px solid rgba(226,185,111,0.35); }
    .date-pill.past { background: var(--surface2); color: var(--muted2); border: 1px solid var(--border); }
    .date-line { flex:1; height:1px; background: var(--border); }
    .date-full { font-size: 0.65rem; color: var(--muted); white-space: nowrap; }

    .table-wrap { background: var(--surface); border: 1px solid var(--border); border-radius: 12px; overflow: hidden; }
    table { width: 100%; border-collapse: collapse; }
    thead tr { background: var(--surface2); border-bottom: 1px solid var(--border2); }
    th { padding: 10px 16px; text-align: left; font-size: 0.6rem; text-transform: uppercase; letter-spacing: 1.8px; color: var(--muted2); font-weight: 400; }
    th.right { text-align: right; }
    td { padding: 14px 16px; border-top: 1px solid var(--border); vertical-align: middle; }
    tbody tr:hover td { background: rgba(255,255,255,0.02); }
    .td-time { color: var(--muted2); font-size: 0.82rem; white-space: nowrap; }
    .td-price { font-family: 'Outfit', sans-serif; font-weight: 700; font-size: 1.05rem; color: var(--white); white-space: nowrap; }
    .td-price .mobile-change { display: none; font-family: 'JetBrains Mono', monospace; font-size: 0.72rem; font-weight: 400; margin-top: 3px; }
    .td-change { text-align: right; }
    .badge { display: inline-flex; align-items: center; gap: 4px; padding: 4px 8px; border-radius: 8px; font-size: 0.72rem; font-weight: 500; white-space: nowrap; flex-wrap: wrap; justify-content: flex-end; }
    .badge.up   { background: var(--up-bg);   color: var(--up);   }
    .badge.down { background: var(--down-bg);  color: var(--down); }
    .badge.flat { background: var(--flat-bg);  color: var(--muted2); }
    .badge-pct { font-size: 0.65rem; opacity: 0.8; }

    /* ── SEO Sections ── */
    .seo-section { margin-bottom: 2rem; }
    .seo-h2 { font-family: 'Outfit', sans-serif; font-size: 1.1rem; font-weight: 800; color: var(--white); margin-bottom: 0.75rem; letter-spacing: -0.3px; }
    .seo-p { font-size: 0.82rem; color: var(--muted2); line-height: 1.8; margin-bottom: 0.5rem; }
    .seo-p strong { color: var(--white); font-weight: 700; }

    /* ── Weekly Card ── */
    .seo-card { background: var(--surface); border: 1px solid var(--border); border-radius: 12px; padding: 1.25rem 1.5rem; margin-bottom: 2rem; }
    .seo-card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.25rem; flex-wrap: wrap; gap: 0.5rem; }
    .seo-card-title { font-family: 'Outfit', sans-serif; font-size: 0.75rem; font-weight: 800; text-transform: uppercase; letter-spacing: 1.5px; color: var(--accent); }
    .seo-card-date { font-size: 0.65rem; color: var(--muted); }
    .seo-card-stats { display: flex; flex-wrap: wrap; gap: 0.5rem 0; border-top: 1px solid var(--border); padding-top: 1rem; }
    .seo-stat { flex: 1; min-width: 80px; padding-right: 1rem; }
    .seo-stat + .seo-stat { padding-left: 1rem; border-left: 1px solid var(--border); }
    .seo-stat-label { font-size: 0.6rem; text-transform: uppercase; letter-spacing: 1.5px; color: var(--muted); margin-bottom: 5px; }
    .seo-stat-val { font-family: 'Outfit', sans-serif; font-size: 1.3rem; font-weight: 700; color: var(--white); }
    .seo-stat-val.up   { color: var(--up); }
    .seo-stat-val.down { color: var(--down); }

    footer { text-align: center; font-size: 0.65rem; color: var(--muted); letter-spacing: 1px; padding-top: 1.5rem; border-top: 1px solid var(--border); margin-top: 3rem; }
    .empty { text-align: center; padding: 4rem; color: var(--muted); font-size: 0.85rem; }

    @media (max-width: 600px) {
      .topbar { padding: 0 1rem; }
      main { padding: 1.25rem 1rem 4rem; }
      .hero { padding: 1.25rem; border-radius: 12px; margin-bottom: 1.5rem; }
      .hero-price { font-size: 2.65rem; letter-spacing: -1.5px; }
      .hero-currency { font-size: 1.2rem; }
      .hero-change { font-size: 1.2rem; }
      .td-price .mobile-change { display: none; }
      th, td { padding: 12px 12px; }
      .td-price { font-size: 0.95rem; }
      .stat-val { font-size: 0.88rem; }
      .stat { min-width: 70px; }
      .date-full { display: none; }
      .cta-box { flex-direction: column; align-items: stretch; }
      .cta-box a { width: 100%; justify-content: center; }
      .nav-tab { padding: 5px 10px; font-size: 0.65rem; }
      .lang-switch { padding: 5px 8px; font-size: 0.6rem; }
      .seo-stat-val { font-size: 1rem; }
      .seo-h2 { font-size: 0.95rem; }
    }
  </style>
</head>
<body>

<h1 class="seo-h1">Harga Emas Public Gold Hari Ini - 24 Hours Price Tracker</h1>

<div class="topbar">
  <div class="topbar-logo">Public<span>Gold</span>Price</div>
  <div class="topbar-right">
    <div class="topbar-nav">
      <a class="nav-tab active" href="/ms/">Emas</a>
      <a class="nav-tab inactive" href="/ms/silver.html">Perak</a>
    </div>
    <a class="lang-switch" href="/">EN</a>
  </div>
</div>

<main>
  <div id="content"><div class="empty">Loading…</div></div>

  <!-- SEO Section 4: What is GAP 24K -->
  <div class="seo-section" style="margin-top:2.5rem">
    <h2 class="seo-h2">Apa Itu Public Gold GAP 24K?</h2>
    <p class="seo-p">Public Gold GAP 24K atau Gold Accumulation Program adalah program pelaburan emas patuh syariah yang ditawarkan oleh Public Gold Malaysia. Program ini membolehkan pelabur membeli dan menyimpan emas tulen 24 karat secara berperingkat bermula dari jumlah yang kecil. Harga emas GAP 24K dikemaskini mengikut harga emas dunia dan boleh berubah pada bila-bila masa. PublicGoldPrice.com merekodkan setiap perubahan harga ini untuk kemudahan rujukan pelabur.</p>
  </div>

  <!-- SEO Section 5: Shariah Compliant -->
  <div class="seo-section">
    <h2 class="seo-h2">Public Gold GAP 24K — 100% Patuh Syariah</h2>
    <p class="seo-p">Public Gold Malaysia merupakan syarikat pertama di dunia yang mendapat pensijilan patuh Syariah untuk urus niaga emas dan perak, termasuk program GAP 24K. Pensijilan ini dikeluarkan oleh <strong>Amanie Advisors Sdn. Bhd.</strong>, sebuah firma penasihat Syariah bertaraf antarabangsa yang diiktiraf. Ini bermakna setiap transaksi pembelian, pembayaran ansuran (EPP), buyback, dan program simpanan melalui Public Gold adalah halal dan sah mengikut hukum Syariah Islam. Anda boleh melabur dengan tenang dan yakin.</p>
    <p class="seo-p" style="margin-top:0.75rem">Untuk maklumat lanjut mengenai Public Gold, sila lawati — <a href="https://publicgold.com.my/index.php?route=information/information&information_id=46" target="_blank" rel="noopener" style="color:#e2b96f;text-decoration:none;border-bottom:1px solid rgba(226,185,111,0.4)">Soalan Lazim Public Gold</a></p>
  </div>
  <!-- SEO Section 6: About -->
  <div class="seo-section">
    <h2 class="seo-h2">Tentang PublicGoldPrice.com</h2>
    <p class="seo-p">PublicGoldPrice.com adalah laman web penjejak harga emas dan perak Public Gold secara langsung (<em>live</em>) yang dibangunkan oleh dealer Public Gold bertauliah. Laman web ini memaparkan harga terkini Public Gold GAP 24K dan SAP 999 yang dikemaskini setiap 3 minit, berserta rekod harga harian untuk rujukan anda.</p>
    <p class="seo-p" style="margin-top:0.6rem">Laman web ini sesuai digunakan oleh:</p>
    <ul style="margin:0.5rem 0 0 1.25rem;display:flex;flex-direction:column;gap:0.4rem">
      <li class="seo-p" style="margin-bottom:0">Ahli Public Gold yang ingin memantau pergerakan harga emas dan perak setiap hari</li>
      <li class="seo-p" style="margin-bottom:0">Pelabur yang ingin mengesan masa terbaik untuk membeli atau menambah simpanan emas dan perak</li>
      <li class="seo-p" style="margin-bottom:0">Orang awam yang ingin mengetahui harga semasa emas dan perak Public Gold tanpa perlu log masuk ke akaun</li>
    </ul>
  </div>
  <div style="margin-top:2.5rem;padding:1.25rem 1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:12px;margin-bottom:1.5rem">
    <p style="font-size:0.72rem;color:var(--muted2);line-height:1.7">Data dan harga Emas yang dipaparkan di laman ini adalah berdasarkan harga rasmi terkini daripada Public Gold Malaysia di bawah Program Simpanan Emas (24K). Harga adalah tertakluk kepada perubahan tanpa notis.</p>
  </div>
  <footer>
    publicgoldprice.com · Harga Emas (RM/g) · Dikemaskini setiap 3 minit · Kemaskini: <span id="last-updated">—</span><br><br>Penafian: PublicGoldPrice.com merupakan website inisiatif dealer Public Gold dan bukan website rasmi Public Gold Marketing Sdn. Bhd.
  </footer>
</main>

<script>
  const SHEET_ID   = '1nct9s5DQAzU1ql7h3p3Or8YPUZFRuYdnjawcYkKmojM';
  const SHEET_GID  = '0';
  const REFRESH_MS = 180_000;

  let countdown = REFRESH_MS / 1000;
  setInterval(() => {
    countdown--;
    if (countdown <= 0) countdown = REFRESH_MS / 1000;
    const el = document.getElementById('countdown-txt');
    if (el) el.textContent = 'Kemaskini dalam ' + countdown + 's';
  }, 1000);

  function parseGDate(val) {
    if (!val) return null;
    const s = String(val);
    const gd = s.match(/Date\((\d+),(\d+),(\d+)\)/);
    if (gd) return new Date(+gd[1], +gd[2], +gd[3]);
    const dmy = s.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);
    if (dmy) return new Date(+dmy[3], +dmy[2] - 1, +dmy[1]);
    const iso = new Date(s);
    return isNaN(iso) ? null : iso;
  }

  function isToday(d) {
    const n = new Date();
    return d.getFullYear()===n.getFullYear() && d.getMonth()===n.getMonth() && d.getDate()===n.getDate();
  }

  function fmtDate(d) {
    return d.toLocaleDateString('ms-MY', { weekday:'long', day:'numeric', month:'long', year:'numeric' });
  }

  function fmtShort(d) {
    return d.toLocaleDateString('ms-MY', { day:'numeric', month:'short', year:'numeric' });
  }

  function fmtTime(t) {
    if (!t) return '—';
    const [h, m] = t.split(':').map(Number);
    if (isNaN(h)) return t;
    const ampm = h >= 12 ? 'PM' : 'AM';
    const h12  = h % 12 || 12;
    return h12 + ':' + String(m).padStart(2,'0') + ' ' + ampm;
  }

  function fmtPrice(p) {
    return p.toLocaleString('en-MY', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
  }

  function parseCSV(text) {
    return text.trim().split('\n').slice(1).map(line => {
      const cols = []; let cur = '', inQ = false;
      for (const ch of line) {
        if (ch === '"') inQ = !inQ;
        else if (ch === ',' && !inQ) { cols.push(cur.trim()); cur = ''; }
        else cur += ch;
      }
      cols.push(cur.trim());
      return cols;
    });
  }

  async function fetchData() {
    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=${SHEET_GID}`;
    const text = await (await fetch(url)).text();
    return parseCSV(text)
      .filter(r => r[0])
      .map(r => ({ date: parseGDate(r[0]), time: r[1] ?? '', price: parseFloat(r[2]) }))
      .filter(r => r.date && !isNaN(r.price))
      .sort((a,b) => b.date - a.date || b.time.localeCompare(a.time));
  }

  function badge(curr, prev) {
    if (prev == null) return '<span class="badge flat">—</span>';
    const diff = curr - prev, pct = ((diff/prev)*100).toFixed(2);
    if (diff > 0) return `<span class="badge up">▲ RM ${fmtPrice(diff)} <span class="badge-pct">+${pct}%</span></span>`;
    if (diff < 0) return `<span class="badge down">▼ RM ${fmtPrice(Math.abs(diff))} <span class="badge-pct">${pct}%</span></span>`;
    return '<span class="badge flat">Tiada Perubahan</span>';
  }

  function mobileChange(curr, prev) {
    if (prev == null) return '';
    const diff = curr - prev, pct = ((diff/prev)*100).toFixed(2);
    if (diff > 0) return `<span class="mobile-change" style="color:var(--up)">▲ RM ${fmtPrice(diff)} (+${pct}%)</span>`;
    if (diff < 0) return `<span class="mobile-change" style="color:var(--down)">▼ RM ${fmtPrice(Math.abs(diff))} (${pct}%)</span>`;
    return `<span class="mobile-change" style="color:var(--muted2)">Tiada Perubahan</span>`;
  }

  function groupByDate(records) {
    const map = {};
    records.forEach(r => {
      const k = r.date.toDateString();
      if (!map[k]) map[k] = { date: r.date, entries: [] };
      map[k].entries.push(r);
    });
    return Object.values(map).sort((a,b) => b.date - a.date);
  }

  function render(records) {
    if (!records.length) {
      document.getElementById('content').innerHTML = '<div class="empty">Tiada data dijumpai.</div>';
      return;
    }

    const groups = groupByDate(records);
    let html = '';

    groups.forEach((group, gi) => {
      const today   = isToday(group.date);
      const entries = group.entries;
      const latest  = entries[0];
      const oldest  = entries[entries.length - 1];

      if (today && gi === 0) {
        const dayDiff = entries.length > 1 ? latest.price - oldest.price : null;
        const dayPct  = dayDiff != null ? ((dayDiff / oldest.price) * 100).toFixed(2) : null;
        const high    = Math.max(...entries.map(e => e.price));
        const low     = Math.min(...entries.map(e => e.price));

        let changeClass = 'flat', changeStr = '—', changeSub = 'rekod pertama hari ini';
        if (dayDiff != null) {
          if (dayDiff > 0)      { changeClass='up';   changeStr=`+RM ${fmtPrice(dayDiff)}`;            changeSub=`+${dayPct}% hari ini`; }
          else if (dayDiff < 0) { changeClass='down';  changeStr=`-RM ${fmtPrice(Math.abs(dayDiff))}`; changeSub=`${dayPct}% hari ini`; }
          else                  { changeStr='Tiada Perubahan'; changeSub='tiada perubahan hari ini'; }
        }

        html += `
        <div style="display:flex;justify-content:space-between;align-items:center;gap:0.6rem;margin-bottom:0.6rem">
          <div style="font-family:'Outfit',sans-serif;font-weight:800;font-size:2.2rem;letter-spacing:0px;color:#e2b96f;line-height:1;text-transform:uppercase">EMAS</div>
          <div style="display:flex;align-items:center;gap:0.6rem">
            <span style="font-size:0.65rem;color:var(--muted);font-family:'JetBrains Mono',monospace" id="countdown-txt">Kemaskini dalam 180s</span>
            <div class="live-badge"><span class="live-dot"></span> Langsung</div>
          </div>
        </div>
        <div class="hero" style="margin-top:0.8rem">
          <div class="hero-top">
            <div>
              <div class="hero-label">Harga Semasa</div>
              <div class="hero-price-wrap">
                <span class="hero-currency">RM</span>
                <span class="hero-price">${fmtPrice(latest.price)}</span>
                <span class="hero-unit">/g</span>
              </div>
            </div>
            <div class="hero-change-wrap">
              <div class="hero-change ${changeClass}">${changeStr}</div>
              <div class="hero-change-sub" style="color:${changeClass==='up'?'var(--up)':changeClass==='down'?'var(--down)':'var(--muted)'}">${changeSub}</div>
            </div>
          </div>
          <div class="hero-stats">
            <div class="stat"><div class="stat-label">Kemaskini Terakhir</div><div class="stat-val">${fmtTime(latest.time)}</div></div>
            <div class="stat"><div class="stat-label">Perubahan Hari Ini</div><div class="stat-val">${entries.length}</div></div>
            <div class="stat"><div class="stat-label">Tertinggi Hari Ini</div><div class="stat-val up">RM ${fmtPrice(high)}</div></div>
            <div class="stat"><div class="stat-label">Terendah Hari Ini</div><div class="stat-val down">RM ${fmtPrice(low)}</div></div>
          </div>
        </div>`;
      }

      if (today && gi === 0) {
        html += `
        <p style="font-size:0.72rem;color:var(--muted2);line-height:1.7;margin-bottom:1.25rem">Semua harga adalah berdasarkan kadar rasmi <a href="https://publicgold.com.my/" target="_blank" rel="noopener" style="color:#e2b96f;text-decoration:none;border-bottom:1px solid rgba(226,185,111,0.4)">Public Gold Malaysia GAP 24K</a> dan tertakluk kepada perubahan. Harga dikemaskini setiap 3 minit dan direkodkan setiap hari.</p>
        <div class="cta-box" style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:1rem;margin-bottom:2rem;padding:1.25rem 1.5rem;background:var(--surface);border:1px solid var(--border2);border-radius:12px;">
          <div style="flex:1;min-width:200px">
            <p style="font-family:'Outfit',sans-serif;font-size:0.95rem;font-weight:700;color:var(--white);line-height:1.4;margin-bottom:0.3rem">Belum jadi ahli Public Gold? Mulakan pelaburan Emas &amp; Perak anda serendah RM100 sebulan je!</p>
            <p style="font-size:0.7rem;color:var(--muted2);letter-spacing:0.3px">Daftar Percuma, 100% Patuh Syariah</p>
          </div>
          <a href="https://publicgold.com.my/index.php?route=account/register&is_dealer=1&intro_pgcode=PG00258585" target="_blank" rel="noopener" style="text-decoration:none;white-space:nowrap;display:inline-flex;align-items:center;gap:8px;font-family:'Outfit',sans-serif;font-weight:800;font-size:0.85rem;letter-spacing:0.5px;padding:12px 24px;border-radius:10px;background:linear-gradient(135deg,#c8943a,#e2b96f,#c8943a);background-size:200% auto;color:#0a0a0f;box-shadow:0 4px 20px rgba(226,185,111,0.35);transition:all 0.3s" onmouseover="this.style.backgroundPosition='right center';this.style.boxShadow='0 6px 28px rgba(226,185,111,0.55)'" onmouseout="this.style.backgroundPosition='left center';this.style.boxShadow='0 4px 20px rgba(226,185,111,0.35)'">
            Daftar Sekarang &nbsp;→
          </a>
        </div>`;
      }

      const pillClass = today ? 'today' : 'past';
      const pillLabel = today ? "Rekod Harga Hari Ini" : fmtShort(group.date);

      html += `
      <div class="date-section" style="animation-delay:${gi*0.05}s">
        <div class="date-row">
          <div class="date-pill ${pillClass}">${pillLabel}</div>
          <div class="date-line"></div>
          ${!today ? `<span class="date-full">${fmtDate(group.date)}</span>` : ''}
        </div>
        <div class="table-wrap">
          <table>
            <thead><tr><th>Masa</th><th>HARGA / g</th><th class="right">Perubahan</th></tr></thead>
            <tbody>`;

      entries.forEach((e, i) => {
        const prev = entries[i+1]?.price ?? null;
        html += `
              <tr>
                <td class="td-time">${fmtTime(e.time)}</td>
                <td class="td-price">RM ${fmtPrice(e.price)}${mobileChange(e.price, prev)}</td>
                <td class="td-change">${badge(e.price, prev)}</td>
              </tr>`;
      });

      html += '</tbody></table></div></div>';

      // ── SEO Sections 1, 2, 3 — after today table ──────────────
      if (today && gi === 0) {

        // S1: Today paragraph
        const todayFormatted = group.date.toLocaleDateString('ms-MY', {day:'numeric', month:'long', year:'numeric'});
        const diffToday = entries.length > 1 ? latest.price - oldest.price : null;
        let moveWord = 'tiada perubahan';
        if (diffToday != null) {
          if (diffToday > 0) moveWord = 'naik';
          else if (diffToday < 0) moveWord = 'turun';
        }

        html += `
        <div class="seo-section" style="margin-top:2rem">
          <h2 class="seo-h2">Harga Emas Public Gold Hari Ini</h2>
          <p class="seo-p">${todayFormatted} — Harga emas Public Gold terkini hari ini adalah <strong>RM ${fmtPrice(latest.price)}</strong> segram, direkodkan pada pukul <strong>${fmtTime(latest.time)}</strong>.${diffToday != null && diffToday !== 0 ? ` Harga ini ${moveWord} <strong>RM ${fmtPrice(Math.abs(diffToday))}</strong> berbanding harga pertama hari ini (<strong>RM ${fmtPrice(oldest.price)}</strong>).` : ''}</p>
          <p class="seo-p">Harga emas yang dipaparkan adalah harga emas Public Gold GAP 24K untuk hari ini. Harga ini boleh berubah setiap hari mengikut pergerakan harga emas dunia. Setiap perubahan harga direkodkan oleh PublicGoldPrice.com untuk kemudahan rujukan anda.</p>
        </div>`;

        // S2: Yesterday paragraph
        if (groups[1]) {
          const yest     = groups[1];
          const yestDate = yest.date.toLocaleDateString('ms-MY', {day:'numeric', month:'long', year:'numeric'});
          const yestLast = yest.entries[0];
          const yestHigh = yest.entries.reduce((a,b) => a.price > b.price ? a : b);
          const yestLow  = yest.entries.reduce((a,b) => a.price < b.price ? a : b);

          html += `
          <div class="seo-section">
            <h2 class="seo-h2">Harga Emas Public Gold Semalam — ${yestDate}</h2>
            <p class="seo-p">Harga emas Public Gold terakhir semalam adalah <strong>RM ${fmtPrice(yestLast.price)}</strong> segram. Harga tertinggi semalam direkodkan pada pukul <strong>${fmtTime(yestHigh.time)}</strong> dengan harga <strong>RM ${fmtPrice(yestHigh.price)}</strong> segram, manakala harga terendah direkodkan pada pukul <strong>${fmtTime(yestLow.time)}</strong> dengan harga <strong>RM ${fmtPrice(yestLow.price)}</strong> segram.</p>
          </div>`;
        }

        // S3: Weekly summary card
        const now       = new Date();
        const weekStart = new Date(now);
        weekStart.setDate(weekStart.getDate() - 6);
        weekStart.setHours(0,0,0,0);
        const weekRecs  = records.filter(r => r.date >= weekStart);
        if (weekRecs.length) {
          const wHigh   = Math.max(...weekRecs.map(r => r.price));
          const wLow    = Math.min(...weekRecs.map(r => r.price));
          const wAvg    = weekRecs.reduce((s,r) => s + r.price, 0) / weekRecs.length;
          const wCount  = weekRecs.length;
          const wStartF = weekStart.toLocaleDateString('ms-MY', {day:'numeric', month:'short'});
          const wEndF   = now.toLocaleDateString('ms-MY', {day:'numeric', month:'short', year:'numeric'});

          html += `
          <div class="seo-card">
            <div class="seo-card-header">
              <span class="seo-card-title">Ringkasan Harga Emas Minggu Ini</span>
              <span class="seo-card-date">${wStartF} – ${wEndF}</span>
            </div>
            <div class="seo-card-stats">
              <div class="seo-stat"><div class="seo-stat-label">Tertinggi Minggu</div><div class="seo-stat-val up">RM ${fmtPrice(wHigh)}</div></div>
              <div class="seo-stat"><div class="seo-stat-label">Terendah Minggu</div><div class="seo-stat-val down">RM ${fmtPrice(wLow)}</div></div>
              <div class="seo-stat"><div class="seo-stat-label">Purata Minggu</div><div class="seo-stat-val">RM ${fmtPrice(wAvg)}</div></div>
              <div class="seo-stat"><div class="seo-stat-label">Jumlah Rekod</div><div class="seo-stat-val">${wCount}</div></div>
            </div>
          </div>`;
        }
      }
    });

    document.getElementById('content').innerHTML = html;
    document.getElementById('last-updated').textContent = new Date().toLocaleTimeString('en-GB');
  }

  async function refresh() {
    countdown = REFRESH_MS / 1000;
    try {
      render(await fetchData());
    }
    catch(e) { console.error(e); document.getElementById('last-updated').textContent = 'Error — retrying…'; }
  }

  refresh();
  setInterval(refresh, REFRESH_MS);
</script>
</body>
</html>
